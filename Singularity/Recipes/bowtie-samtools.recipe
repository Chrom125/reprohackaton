Bootstrap: docker
From: ubuntu:24.04

%post
    # Install dependencies
    apt update && apt install -y autoconf automake make gcc perl zlib1g-dev libbz2-dev liblzma-dev libcurl4-gnutls-dev libssl-dev libncurses5-dev libdeflate-dev wget unzip bzip2 
    rm -rf /var/lib/apt/lists/*

    # Install bowtie v0.12.7
    wget "https://sourceforge.net/projects/bowtie-bio/files/bowtie/0.12.7/bowtie-0.12.7-linux-x86_64.zip"
    unzip bowtie-0.12.7-linux-x86_64.zip
    chmod +x /bowtie-0.12.7/*
    rm bowtie-0.12.7-linux-x86_64.zip
    
    # Install samtools v1.22.1
    wget https://github.com/samtools/samtools/releases/download/1.22.1/samtools-1.22.1.tar.bz2
    tar -xjf samtools-1.22.1.tar.bz2
    rm samtools-1.22.1.tar.bz2
    cd samtools-1.22.1
    ./configure --prefix=/samtools/
    make
    make install
    
%environment
    export PATH=/bowtie-0.12.7:/samtools-1.22.1/bin:$PATH

%runscript
case "$1" in
    bowtie-build)
        exec bowtie-build "${@:2}"
        ;;
    bowtie)
        exec bowtie "${@:2}"
        ;;
    samtools)
        exec samtools "${@:2}"
        ;;
esac
